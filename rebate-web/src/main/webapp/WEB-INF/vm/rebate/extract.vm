#set( $title = "提现")
#parse("/common/head.vm")
<body class="bd" ng-app="myApp">
<form name="extractForm" ng-controller="extractCtrl">
<div class="tixian" >
    <div class="inner">
        <div class="tixian-form">
            <div class="box-hd">
                <div class="item">
                    <p class="num"><em>$!{commission.totalCommission}</em>元</p>
                    <span>现金余额</span>
                </div>
                <div class="item two">
                    <img class="img" src="/static/img/img-10.png" alt="">
                    <a href="/rebate/personal/extractDetail">提现记录&gt;</a>
                </div>
            </div>
            <div class="box-bd">
                <div class="form-item mui-flex align-center">
                    <label class="labell cell fixed">微信号：</label>
                    <div class="cnt cell">
                        <input class="ipt" type="text" value="$!{userInfo.openId}" style="background-color: #ffffff;"
                               disabled/>
                    </div>
                </div>
                <div class="form-item mui-flex align-center">
                    <label class="labell cell fixed">手机号：</label>
                    <div class="cnt cell">
                        <input placeholder="请输入手机号" class="ipt" type="tel" id="extractPhone" name="extractPhone" ng-model="extractPhone" ng-minlength="11"
                               ng-pattern="/^1[3|5|7|8|][0-9]\d{4,8}$/" required/>
                    </div>
                </div>
                <div class="form-item mui-flex align-center">
                    <label class="labell cell fixed">可提取金额：</label>
                    <div class="cnt cell">
                        <span><input class="ipt"  type="number"  id="extractPrice" id="extractPrice" name="extractPrice" ng-model="extractPrice" min="1" max="9999"/>元</span>
                    </div>
                </div>
                <div class="form-item mui-flex align-center">
                    <p style="color:red" ng-if="(extractForm.extractPhone.$error.minlength||extractForm.extractPhone.$error.pattern)">请输入有效的手机号码!</p>
                </div>
            </div>
        </div>
        <a href="javascript:;" class="submit-btn disabled"  ng-if="(extractForm.extractPhone.$error.minlength||extractForm.extractPhone.$error.pattern)">确认申请</a>
        <a href="javascript:;" class="submit-btn" ng-click="submitExtract()" ng-if="(!extractForm.extractPhone.$error.minlength && !extractForm.extractPhone.$error.pattern)">确认申请</a>
    </div>
</div>
</form>
<script>
    var app = angular.module('myApp', []);
    app.controller('extractCtrl', function ($scope,$http,$location) {
        $scope.submitExtract  = function () {
                $http({
                    method: 'GET',
                    params:{
                        extractPhone:$scope.extractPhone,
                        extractPrice:$scope.extractPrice
                    },
                    url: '/rebate/personal/extractPrice.json?callback=1'
                }).then(function successCallback(response) {
                    location.href ='/rebate/personal/extractDetail'
                }, function errorCallback(response) {
                    // 请求失败执行代码
                });
        }
    });
</script>
</body></html>